import{_ as me,m as ge,s as ve,l as E,q as be,v as ce,x as fe,y as ie,z as pe,A as I,B as ye,C as K,o as w,c as U,a as _,F as X,D as se,t as O,E as he,G as j,H as ue,b as o,I as re,J as M,g as _e,r as h,h as ke,n as Z,w as i,i as v,j as c,k as Ve,d as N}from"./7D1AE9KK.js";import{_ as Ae,n as ze,d as de,a as Ie}from"./Jz6b3TTS.js";import{_ as Ce,a as we,b as Ue}from"./Dc5sforu.js";import{_ as Se}from"./DQarQUdS.js";import{u as $e,B,C as ee}from"./qFn4ZVty.js";import{d as Be,_ as Te,a as Oe}from"./Cx4OvYUc.js";import"./BAWvFiHX.js";const C=ge(E.ui.strategy,E.ui.select,ve),Fe=be({components:{UIcon:ce},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>C.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>C.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(e){return Object.keys(C.size).includes(e)}},color:{type:String,default:()=>C.default.color,validator(e){return[...E.ui.colors,...Object.keys(C.color)].includes(e)}},variant:{type:String,default:()=>C.default.variant,validator(e){return[...Object.keys(C.variant),...Object.values(C.color).flatMap(k=>Object.keys(k))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:k,slots:S}){const{ui:n,attrs:V}=fe("select",ie(e,"ui"),C,ie(e,"class")),{size:A,rounded:$}=pe({ui:n,props:e}),{emitFormChange:m,inputId:g,color:u,size:T,name:p}=$e(e,C),d=I(()=>A.value||T.value),y=s=>{k("update:modelValue",s.target.value)},q=s=>{m(),k("change",s)},x=s=>M(s,e.valueAttribute,M(s,e.optionAttribute)),P=s=>M(s,e.optionAttribute,M(s,e.valueAttribute)),R=s=>["string","number","boolean"].includes(typeof s)?{[e.valueAttribute]:s,[e.optionAttribute]:s}:{...s,[e.valueAttribute]:x(s),[e.optionAttribute]:P(s)},D=I(()=>e.options.map(s=>R(s))),G=I(()=>e.placeholder?[{[e.valueAttribute]:"",[e.optionAttribute]:e.placeholder,disabled:!0},...D.value]:D.value),W=I(()=>{const s=R(e.modelValue),z=G.value.find(r=>r[e.valueAttribute]===s[e.valueAttribute]);return z?z[e.valueAttribute]:""}),Y=I(()=>{var z,r;const s=((r=(z=n.value.color)==null?void 0:z[u.value])==null?void 0:r[e.variant])||n.value.variant[e.variant];return ye(K(n.value.base,n.value.form,$.value,n.value.size[d.value],e.padded?n.value.padding[d.value]:"p-0",s==null?void 0:s.replaceAll("{color}",u.value),(F.value||S.leading)&&n.value.leading.padding[d.value],(L.value||S.trailing)&&n.value.trailing.padding[d.value]),e.placeholder&&!e.modelValue&&n.value.placeholder,e.selectClass)}),F=I(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),L=I(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),J=I(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),Q=I(()=>e.loading&&!F.value?e.loadingIcon:e.trailingIcon||e.icon),H=I(()=>K(n.value.icon.leading.wrapper,n.value.icon.leading.pointer,n.value.icon.leading.padding[d.value])),a=I(()=>K(n.value.icon.base,u.value&&E.ui.colors.includes(u.value)&&n.value.icon.color.replaceAll("{color}",u.value),n.value.icon.size[d.value],e.loading&&n.value.icon.loading)),t=I(()=>K(n.value.icon.trailing.wrapper,n.value.icon.trailing.pointer,n.value.icon.trailing.padding[d.value])),b=I(()=>K(n.value.icon.base,u.value&&E.ui.colors.includes(u.value)&&n.value.icon.color.replaceAll("{color}",u.value),n.value.icon.size[d.value],e.loading&&!F.value&&n.value.icon.loading));return{ui:n,attrs:V,name:p,inputId:g,normalizedOptionsWithPlaceholder:G,normalizedValue:W,isLeading:F,isTrailing:L,selectClass:Y,leadingIconName:J,leadingIconClass:a,leadingWrapperIconClass:H,trailingIconName:Q,trailingIconClass:b,trailingWrapperIconClass:t,onInput:y,onChange:q}}}),Ke=["id","name","value","required","disabled"],je=["value","label"],Ne=["value","selected","disabled","textContent"],Ee=["value","selected","disabled","textContent"];function qe(e,k,S,n,V,A){const $=ce;return w(),U("div",{class:j(e.ui.wrapper)},[_("select",he({id:e.inputId,name:e.name,value:e.modelValue,required:e.required,disabled:e.disabled,class:e.selectClass},e.attrs,{onInput:k[0]||(k[0]=(...m)=>e.onInput&&e.onInput(...m)),onChange:k[1]||(k[1]=(...m)=>e.onChange&&e.onChange(...m))}),[(w(!0),U(X,null,se(e.normalizedOptionsWithPlaceholder,(m,g)=>(w(),U(X,null,[m.children?(w(),U("optgroup",{key:`${m[e.valueAttribute]}-optgroup-${g}`,value:m[e.valueAttribute],label:m[e.optionAttribute]},[(w(!0),U(X,null,se(m.children,(u,T)=>(w(),U("option",{key:`${u[e.valueAttribute]}-${g}-${T}`,value:u[e.valueAttribute],selected:u[e.valueAttribute]===e.normalizedValue,disabled:u.disabled,textContent:O(u[e.optionAttribute])},null,8,Ne))),128))],8,je)):(w(),U("option",{key:`${m[e.valueAttribute]}-${g}`,value:m[e.valueAttribute],selected:m[e.valueAttribute]===e.normalizedValue,disabled:m.disabled,textContent:O(m[e.optionAttribute])},null,8,Ee))],64))),256))],16,Ke),e.isLeading&&e.leadingIconName||e.$slots.leading?(w(),U("span",{key:0,class:j(e.leadingWrapperIconClass)},[ue(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[o($,{name:e.leadingIconName,class:j(e.leadingIconClass)},null,8,["name","class"])],!0)],2)):re("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(w(),U("span",{key:1,class:j(e.trailingWrapperIconClass)},[ue(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[o($,{name:e.trailingIconName,class:j(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])],!0)],2)):re("",!0)],2)}const xe=me(Fe,[["render",qe],["__scopeId","data-v-b8160cf8"]]),Re=_("div",{class:"text-2xl font-bold"},"Kitoblar",-1),De={class:"shadow-2xl border border-gray-300 dark:border-gray-500 items-center my-4"},Ge={class:"flex p-4 justify-end"},Le={class:"whitespace-pre-line w-[300px]"},Me=["src"],Pe={class:"flex flex-col items-center justify-center py-6 gap-3"},We=_("span",{class:"italic text-sm"},"Ma'lumot Mavjud Emas",-1),Ye={class:"flex items-center justify-between"},Je=_("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Kitob Qo'shish ",-1),Qe={class:"flex items-center justify-between"},He=_("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Kitob Qo'shish ",-1),na={__name:"index",setup(e){const k=_e();let S=h([]),n=h(!1),V=h(!1),A=h(!0),$=h([]),m=h(null),g=h(""),u=h(""),T=h(null),p=h(""),d=h(""),y=h(null),q=h(null),x=h(null);ke(async()=>{try{const a=await $fetch(B+"/books",{method:"GET"});S.value=a.data;const t=await $fetch(B+"/categories",{method:"GET"});$.value=t.data,A.value=!1}catch(a){a.response&&a.response.status===401&&(localStorage.removeItem("token"),Z("/exit")),console.log(a)}});const P=[{key:"name",label:"Nomi"},{key:"photo_url",label:"Rasm"},{key:"description",label:"Batafsil"},{key:"author",label:"Yozuvchi"},{key:"price",label:"Narxi"},{key:"category",label:"Kategoriyasi"},{key:"createdAt",label:"Yaratilgan vaqti"},{key:"updatedAt",label:"Yangilangan vaqti"},{key:"actions",label:"Action"}],R=a=>[[{label:"Tahrirlash",icon:"i-heroicons-pencil-square-20-solid",click:()=>D(a)},{label:"O'chirish",icon:"i-heroicons-trash-20-solid",click:()=>F(a._id)}],[{label:"Yuklab Olish(Kitob)",icon:"i-heroicons-archive-box-arrow-down",click:()=>W(a.book_url,a.name)},{label:"Yuklab Olish(Audio)",icon:"i-heroicons-archive-box-arrow-down",click:()=>Y(a.book_audio_url,a.name)}]],D=async a=>{V.value=!0,m.value=a._id,g.value=a.name,u.value=a.description,p.value=a.author,d.value=a.category._id,y.value=a.price},G=async()=>{A.value=!0;try{await $fetch(B+`/books/${m.value}`,{method:"PUT",body:JSON.stringify({name:g.value,description:u.value,author:p.value,category:d.value,price:y.value}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});const a=await $fetch(B+"/books",{method:"GET"});g.value="",u.value="",p.value="",d.value="",y.value="",S.value=a.data,V.value=!1,A.value=!1}catch(a){console.log(a)}V.value=!1},W=async(a,t)=>{const s=await(await fetch(a)).blob(),z=window.URL.createObjectURL(s),r=document.createElement("a");r.href=z,r.download=`${t}.pdf`,r.click()},Y=async(a,t)=>{const s=await(await fetch(a)).blob(),z=window.URL.createObjectURL(s),r=document.createElement("a");r.href=z,r.download=`${t}.mp3`,r.click()},F=async a=>{A.value=!0;try{const t=await $fetch(B+"/books/"+a,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.status===200){k.add({title:t.message});const b=await $fetch(B+"/books",{method:"GET"});S.value=b.data}else k.add({title:t.message})}catch(t){t.response&&t.response.status===401&&(localStorage.removeItem("token"),Z("/exit")),console.log(t)}A.value=!1};function L(a){a.target.files.length>0&&(T.value=a.target.files[0])}function J(a){a.target.files.length>0&&(q.value=a.target.files[0])}function Q(a){a.target.files.length>0&&(x.value=a.target.files[0])}const H=async()=>{A.value=!0;try{let a=new FormData;a.append("file",T.value);const t=await $fetch(ee+"/upload",{method:"POST",body:a});a=new FormData,a.append("file",q.value);const b=await $fetch(ee+"/upload",{method:"POST",body:a});a=new FormData,a.append("file",x.value);const s=await $fetch(ee+"/upload",{method:"POST",body:a}),z=await $fetch(B+"/books",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({photo_url:t.data.fileUrl,book_audio_url:b.data.fileUrl,book_url:s.data.fileUrl,name:g.value,description:u.value,author:p.value,category:d.value,price:y.value})});n.value=!1,k.add({title:z.message});const r=await $fetch(B+"/books",{method:"GET"});T.value=null,S.value=r.data}catch(a){a.response&&a.response.status===401&&(localStorage.removeItem("token"),Z("/exit")),console.log(a)}A.value=!1};return Be({escape:{usingInput:!0,whenever:[n],handler:()=>{n.value=!1}}}),(a,t)=>{const b=Ve,s=Ie,z=Ae,r=Ce,f=we,ae=Se,le=xe,te=Ue,oe=Oe,ne=Te;return w(),U("div",null,[Re,_("div",De,[_("div",Ge,[o(b,{size:"lg",onClick:t[0]||(t[0]=l=>v(n)?n.value=!0:n=!0)},{default:i(()=>[N("Kitob Qo'shish")]),_:1})])]),o(z,{loading:c(A),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Yuklanmoqda..."},progress:{color:"primary",animation:"carousel"},columns:P,rows:c(S),"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Bannerlar Mavjud Emas"}},{"description-data":i(({row:l})=>[_("div",Le,O(l.description),1)]),"price-data":i(({row:l})=>[_("div",null,O(("numberFormat"in a?a.numberFormat:c(ze))(l.price))+" so'm",1)]),"photo_url-data":i(({row:l})=>[_("img",{src:l.photo_url,alt:"",class:"max-w-[100px]"},null,8,Me)]),"category-data":i(({row:l})=>[_("div",null,O(l.category.name),1)]),"createdAt-data":i(({row:l})=>[N(O(("dateFormat"in a?a.dateFormat:c(de))(l.createdAt)),1)]),"updatedAt-data":i(({row:l})=>[N(O(("dateFormat"in a?a.dateFormat:c(de))(l.updatedAt)),1)]),"actions-data":i(({row:l})=>[o(s,{items:R(l)},{default:i(()=>[o(b,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),"empty-state":i(()=>[_("div",Pe,[We,o(b,{label:"Kitob Qo'shish",onClick:t[1]||(t[1]=l=>v(n)?n.value=!0:n=!0)})])]),_:1},8,["loading","loading-state","rows"]),o(ne,{modelValue:c(n),"onUpdate:modelValue":t[8]||(t[8]=l=>v(n)?n.value=l:n=l),"prevent-close":""},{default:i(()=>[o(oe,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:i(()=>[_("div",Ye,[Je,o(b,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:t[2]||(t[2]=l=>v(n)?n.value=!1:n=!1)})])]),default:i(()=>[o(te,{onSubmit:H},{default:i(()=>[o(f,{class:"my-[2%]",label:"Kitob Nomi",size:"lg"},{default:i(()=>[o(r,{type:"text",size:"lg",modelValue:c(g),"onUpdate:modelValue":t[3]||(t[3]=l=>v(g)?g.value=l:g=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Rasmi",size:"lg"},{default:i(()=>[o(r,{type:"file",size:"lg",onChange:L})]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Haqida",name:"photo"},{default:i(()=>[o(ae,{type:"text",size:"lg",modelValue:c(u),"onUpdate:modelValue":t[4]||(t[4]=l=>v(u)?u.value=l:u=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Muallifi",name:"photo"},{default:i(()=>[o(r,{type:"text",size:"lg",modelValue:c(p),"onUpdate:modelValue":t[5]||(t[5]=l=>v(p)?p.value=l:p=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Kategoriyasi",name:"photo"},{default:i(()=>[o(le,{type:"text",size:"lg",options:c($),"option-attribute":"name","value-attribute":"_id",modelValue:c(d),"onUpdate:modelValue":t[6]||(t[6]=l=>v(d)?d.value=l:d=l)},null,8,["options","modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Narxi",name:"photo"},{default:i(()=>[o(r,{type:"number",size:"lg",modelValue:c(y),"onUpdate:modelValue":t[7]||(t[7]=l=>v(y)?y.value=l:y=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob PDF fayli",name:"photo"},{default:i(()=>[o(r,{type:"file",size:"lg",onChange:Q})]),_:1}),o(f,{class:"my-[2%]",label:"Kitob audio fayli",name:"photo"},{default:i(()=>[o(r,{type:"file",size:"lg",onChange:J})]),_:1}),o(f,{class:"my-[2%]",name:"submit",size:"xl"},{default:i(()=>[o(b,{loading:c(A),type:"submit",color:"primary",size:"xl",block:""},{default:i(()=>[N("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ne,{modelValue:c(V),"onUpdate:modelValue":t[15]||(t[15]=l=>v(V)?V.value=l:V=l),"prevent-close":""},{default:i(()=>[o(oe,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:i(()=>[_("div",Qe,[He,o(b,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:t[9]||(t[9]=l=>v(V)?V.value=!1:V=!1)})])]),default:i(()=>[o(te,{onSubmit:G},{default:i(()=>[o(f,{class:"my-[2%]",label:"Kitob Nomi",size:"lg"},{default:i(()=>[o(r,{type:"text",size:"lg",modelValue:c(g),"onUpdate:modelValue":t[10]||(t[10]=l=>v(g)?g.value=l:g=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Haqida",name:"photo"},{default:i(()=>[o(ae,{type:"text",size:"lg",modelValue:c(u),"onUpdate:modelValue":t[11]||(t[11]=l=>v(u)?u.value=l:u=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Muallifi",name:"photo"},{default:i(()=>[o(r,{type:"text",size:"lg",modelValue:c(p),"onUpdate:modelValue":t[12]||(t[12]=l=>v(p)?p.value=l:p=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Kategoriyasi",name:"photo"},{default:i(()=>[o(le,{type:"text",size:"lg",options:c($),"option-attribute":"name","value-attribute":"_id",modelValue:c(d),"onUpdate:modelValue":t[13]||(t[13]=l=>v(d)?d.value=l:d=l)},null,8,["options","modelValue"])]),_:1}),o(f,{class:"my-[2%]",label:"Kitob Narxi",name:"photo"},{default:i(()=>[o(r,{type:"number",size:"lg",modelValue:c(y),"onUpdate:modelValue":t[14]||(t[14]=l=>v(y)?y.value=l:y=l)},null,8,["modelValue"])]),_:1}),o(f,{class:"my-[2%]",name:"submit",size:"xl"},{default:i(()=>[o(b,{loading:c(A),type:"submit",color:"primary",size:"xl",block:""},{default:i(()=>[N("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{na as default};

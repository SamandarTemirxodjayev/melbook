import{a1 as O,r as h,v as q,a2 as T,c as D,a as r,b as o,w as l,a3 as m,h as d,a4 as G,o as R,d as v,t as y}from"./BITG7RQi.js";import{_ as Y,j as L}from"./D3M_IfAI.js";import{a as P,_ as Q,b as J}from"./CG19ain6.js";import{_ as H}from"./i0JWel_3.js";import{d as K,_ as W,a as X}from"./PupqcIUV.js";import{B as f,C as Z}from"./DbmDtxZi.js";import{d as V}from"./yughPfh0.js";import"./DoTr83gx.js";const ee=r("div",{class:"text-2xl font-bold"},"Eslatmalar",-1),te={class:"shadow-2xl border border-gray-500 items-center my-4"},ae={class:"flex p-4 justify-end"},oe=["src"],le={class:"whitespace-pre-wrap"},ne={class:"whitespace-pre-wrap"},se={class:"flex flex-col items-center justify-center py-6 gap-3"},ie=r("span",{class:"italic text-sm"},"Ma'lumot Mavjud Emas",-1),re={class:"flex items-center justify-between"},de=r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Eslatma Qo'shish ",-1),ce={class:"flex items-center justify-between"},ue=r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Eslatmani Tahrirlash ",-1),xe={__name:"index",setup(me){const b=O();let g=h([]),n=h(!1),p=h(!1),u=h(!0),x=h(null),s=h(""),i=h(""),U=h(null);q(async()=>{try{const t=await $fetch(f+"/notifications",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});g.value=t.data,u.value=!1}catch(t){t.response&&t.response.status===401&&(localStorage.removeItem("token"),T("/exit")),console.log(t)}});const C=[{key:"photo_url",label:"Rasm"},{key:"title",label:"Sarlavha"},{key:"content",label:"Matn"},{key:"readBy",label:"Ko'rishlar Soni"},{key:"createdAt",label:"Yaratilgan vaqti"},{key:"updatedAt",label:"Yangilangan vaqti"},{key:"actions",label:"Action"}],A=t=>[[{label:"O'chirish",icon:"i-heroicons-trash-20-solid",click:()=>j(t._id)},{label:"Tahrirlash",icon:"i-heroicons-pencil-square-20-solid",click:()=>$(t)}]],$=t=>{p.value=!0,U.value=t._id,s.value=t.title,i.value=t.content},j=async t=>{u.value=!0;try{const a=await $fetch(f+"/notifications/"+t,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(a.status===200){b.add({title:a.message});const c=await $fetch(f+"/notifications",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});g.value=c.data}else b.add({title:a.message})}catch(a){a.response&&a.response.status===401&&(localStorage.removeItem("token"),T("/exit")),console.log(a)}u.value=!1};function I(t){t.target.files.length>0&&(x.value=t.target.files[0])}const F=async()=>{u.value=!0;try{const t=new FormData;t.append("file",x.value);const{data:a}=await $fetch(Z+"/upload",{method:"POST",body:t}),c=await $fetch(f+"/notifications",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({photo_url:a.fileUrl,title:s.value,content:i.value})});n.value=!1,b.add({title:c.message});const k=await $fetch(f+"/notifications",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});x.value=null,s.value="",i.value="",g.value=k.data}catch(t){t.response&&t.response.status===401&&(localStorage.removeItem("token"),T("/exit")),console.log(t)}u.value=!1},M=async()=>{u.value=!0;try{const t=await $fetch(f+"/notifications/"+U.value,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({title:s.value,content:i.value})});b.add({title:t.message});const a=await $fetch(f+"/notifications",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});g.value=a.data,s.value="",i.value="",p.value=!1}catch(t){console.log(t)}u.value=!1};return K({escape:{usingInput:!0,whenever:[n],handler:()=>{n.value=!1}}}),(t,a)=>{const c=G,k=L,N=Y,z=P,_=Q,E=H,S=J,w=X,B=W;return R(),D("div",null,[ee,r("div",te,[r("div",ae,[o(c,{size:"lg",onClick:a[0]||(a[0]=e=>m(n)?n.value=!0:n=!0)},{default:l(()=>[v("Eslatma Qo'shish")]),_:1})])]),o(N,{loading:d(u),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Yuklanmoqda..."},progress:{color:"primary",animation:"carousel"},columns:C,rows:d(g),"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Eslatma Mavjud Emas"}},{"photo_url-data":l(({row:e})=>[r("img",{src:e.photo_url,alt:""},null,8,oe)]),"title-data":l(({row:e})=>[r("div",le,y(e.title),1)]),"content-data":l(({row:e})=>[r("div",ne,y(e.content),1)]),"readBy-data":l(({row:e})=>[r("div",null,y(e.readBy.length),1)]),"createdAt-data":l(({row:e})=>[v(y(("dateFormat"in t?t.dateFormat:d(V))(e.createdAt)),1)]),"updatedAt-data":l(({row:e})=>[v(y(("dateFormat"in t?t.dateFormat:d(V))(e.updatedAt)),1)]),"actions-data":l(({row:e})=>[o(k,{items:A(e)},{default:l(()=>[o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),"empty-state":l(()=>[r("div",se,[ie,o(c,{label:"Eslatma Qo'shish",onClick:a[1]||(a[1]=e=>m(n)?n.value=!0:n=!0)})])]),_:1},8,["loading","loading-state","rows"]),o(B,{modelValue:d(n),"onUpdate:modelValue":a[5]||(a[5]=e=>m(n)?n.value=e:n=e),"prevent-close":""},{default:l(()=>[o(w,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:l(()=>[r("div",re,[de,o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:a[2]||(a[2]=e=>m(n)?n.value=!1:n=!1)})])]),default:l(()=>[o(S,{onSubmit:F},{default:l(()=>[o(_,{class:"my-[2%]",label:"Eslatma Uchun Rasm Tanglang",name:"photo",size:"lg"},{default:l(()=>[o(z,{type:"file",size:"lg",onChange:I})]),_:1}),o(_,{class:"my-[2%]",label:"Eslatma Uchun Sarlavha Yozing",name:"photo",size:"lg"},{default:l(()=>[o(z,{type:"text",size:"lg",modelValue:d(s),"onUpdate:modelValue":a[3]||(a[3]=e=>m(s)?s.value=e:s=e)},null,8,["modelValue"])]),_:1}),o(_,{class:"my-[2%]",label:"Eslatma Uchun Matn Yozing",name:"photo",size:"lg"},{default:l(()=>[o(E,{type:"text",size:"xl",modelValue:d(i),"onUpdate:modelValue":a[4]||(a[4]=e=>m(i)?i.value=e:i=e)},null,8,["modelValue"])]),_:1}),o(_,{class:"my-[2%]",name:"submit",size:"xl"},{default:l(()=>[o(c,{loading:d(u),type:"submit",color:"primary",size:"xl",block:""},{default:l(()=>[v("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(B,{modelValue:d(p),"onUpdate:modelValue":a[9]||(a[9]=e=>m(p)?p.value=e:p=e),"prevent-close":""},{default:l(()=>[o(w,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:l(()=>[r("div",ce,[ue,o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:a[6]||(a[6]=e=>m(p)?p.value=!1:p=!1)})])]),default:l(()=>[o(S,{onSubmit:M},{default:l(()=>[o(_,{class:"my-[2%]",label:"Eslatma Uchun Sarlavha",name:"photo",size:"lg"},{default:l(()=>[o(z,{type:"text",size:"lg",modelValue:d(s),"onUpdate:modelValue":a[7]||(a[7]=e=>m(s)?s.value=e:s=e)},null,8,["modelValue"])]),_:1}),o(_,{class:"my-[2%]",label:"Eslatma Uchun Matn",name:"photo",size:"lg"},{default:l(()=>[o(E,{type:"text",size:"xl",modelValue:d(i),"onUpdate:modelValue":a[8]||(a[8]=e=>m(i)?i.value=e:i=e)},null,8,["modelValue"])]),_:1}),o(_,{class:"my-[2%]",name:"submit",size:"xl"},{default:l(()=>[o(c,{loading:d(u),type:"submit",color:"primary",size:"xl",block:""},{default:l(()=>[v("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{xe as default};

import{a1 as I,r as _,v as N,a2 as b,c as K,a as r,b as o,w as s,a3 as u,h as n,a4 as O,o as F,d as f,t as S}from"./BqDk7vYE.js";import{_ as q,j as U,k as G}from"./6J7fcwRE.js";import{a as M,_ as J,b as D}from"./B16jJ9f5.js";import{d as L,_ as Q,a as Y}from"./Dg9qKYs-.js";import{B as m}from"./D7peMnsk.js";import"./T2nn6245.js";const P=r("div",{class:"text-2xl font-bold"},"Kategoriyalar",-1),R={class:"shadow-2xl border border-gray-500 items-center my-4"},H={class:"flex p-4 justify-end"},W=["src"],X={class:"flex flex-col items-center justify-center py-6 gap-3"},Z=r("span",{class:"italic text-sm"},"Ma'lumot Mavjud Emas",-1),ee={class:"flex items-center justify-between"},te=r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Kategoriyani Tahrirlash ",-1),ae={class:"flex items-center justify-between"},oe=r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Kategoriya Qo'shish ",-1),ue={__name:"index",setup(se){const h=I();let y=_([]),l=_(!1),i=_(!0),g=_(""),p=_(null),d=_(!1);N(async()=>{try{const e=await $fetch(m+"/categories",{method:"GET"});y.value=e.data,i.value=!1}catch(e){return e.response&&e.response.status===401&&(localStorage.removeItem("token"),b("/exit")),console.log(e)}});const C=[{key:"name",label:"Nomi"},{key:"createdAt",label:"Yaratilgan vaqti"},{key:"updatedAt",label:"Yangilangan vaqti"},{key:"actions",label:"Action"}],V=e=>[[{label:"Tahrirlash",icon:"i-heroicons-pencil-square-20-solid",click:()=>$(e)},{label:"O'chirish",icon:"i-heroicons-trash-20-solid",click:()=>z(e._id)}]],z=async e=>{i.value=!0;try{const t=await $fetch(m+"/categories/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.status===200){h.add({title:t.message});const c=await $fetch(m+"/categories",{method:"GET"});y.value=c.data}else h.add({title:t.message})}catch(t){t.response&&t.response.status===401&&(localStorage.removeItem("token"),b("/exit")),console.log(t)}i.value=!1},E=async()=>{i.value=!0;try{const e=await $fetch(m+"/categories",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:g.value})});h.add({title:e.message});const t=await $fetch(m+"/categories",{method:"GET"});l.value=!1,g.value="",y.value=t.data}catch(e){e.response&&e.response.status===401&&(localStorage.removeItem("token"),b("/exit")),console.log(e)}i.value=!1},$=e=>{p.value=JSON.parse(JSON.stringify(e)),d.value=!0},A=async()=>{i.value=!0;try{const e=await $fetch(m+"/categories/"+p.value._id,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:p.value.name})});d.value=!1,h.add({title:e.message});const t=await $fetch(m+"/categories",{method:"GET"});p.value=null,y.value=t.data}catch(e){e.response&&e.response.status===401&&(localStorage.removeItem("token"),b("/exit")),console.log(e)}i.value=!1};return L({escape:{usingInput:!0,whenever:[l],handler:()=>{l.value=!1}}}),(e,t)=>{const c=O,j=G,B=q,x=M,v=J,k=D,T=Y,w=Q;return F(),K("div",null,[P,r("div",R,[r("div",H,[o(c,{size:"lg",onClick:t[0]||(t[0]=a=>u(l)?l.value=!0:l=!0)},{default:s(()=>[f("Kategoriya Qo'shish")]),_:1})])]),o(B,{loading:n(i),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Yuklanmoqda..."},progress:{color:"primary",animation:"carousel"},columns:C,rows:n(y),"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Bannerlar Mavjud Emas"}},{"photo_url-data":s(({row:a})=>[r("img",{src:a.photo_url,alt:""},null,8,W)]),"createdAt-data":s(({row:a})=>[f(S(("dateFormat"in e?e.dateFormat:n(U))(a.createdAt)),1)]),"updatedAt-data":s(({row:a})=>[f(S(("dateFormat"in e?e.dateFormat:n(U))(a.updatedAt)),1)]),"actions-data":s(({row:a})=>[o(j,{items:V(a)},{default:s(()=>[o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),"empty-state":s(()=>[r("div",X,[Z,o(c,{label:"Kategoriya Qo'shish",onClick:t[1]||(t[1]=a=>u(l)?l.value=!0:l=!0)})])]),_:1},8,["loading","loading-state","rows"]),o(w,{modelValue:n(d),"onUpdate:modelValue":t[4]||(t[4]=a=>u(d)?d.value=a:d=a),"prevent-close":""},{default:s(()=>[o(T,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:s(()=>[r("div",ee,[te,o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:t[2]||(t[2]=a=>u(d)?d.value=!1:d=!1)})])]),default:s(()=>[o(k,{onSubmit:A},{default:s(()=>[o(v,{class:"my-[2%]",label:"Kategoriya Uchun Nom Kiriting",name:"photo",size:"lg"},{default:s(()=>[o(x,{type:"text",size:"lg",modelValue:n(p).name,"onUpdate:modelValue":t[3]||(t[3]=a=>n(p).name=a)},null,8,["modelValue"])]),_:1}),o(v,{class:"my-[2%]",name:"submit",size:"lg"},{default:s(()=>[o(c,{loading:n(i),type:"submit",color:"primary",size:"lg",block:""},{default:s(()=>[f("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(w,{modelValue:n(l),"onUpdate:modelValue":t[7]||(t[7]=a=>u(l)?l.value=a:l=a),"prevent-close":""},{default:s(()=>[o(T,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:s(()=>[r("div",ae,[oe,o(c,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:t[5]||(t[5]=a=>u(l)?l.value=!1:l=!1)})])]),default:s(()=>[o(k,{onSubmit:E},{default:s(()=>[o(v,{class:"my-[2%]",label:"Kategoriya Uchun Nom Kiriting",name:"photo",size:"lg"},{default:s(()=>[o(x,{type:"text",size:"lg",modelValue:n(g),"onUpdate:modelValue":t[6]||(t[6]=a=>u(g)?g.value=a:g=a)},null,8,["modelValue"])]),_:1}),o(v,{class:"my-[2%]",name:"submit",size:"lg"},{default:s(()=>[o(c,{loading:n(i),type:"submit",color:"primary",size:"lg",block:""},{default:s(()=>[f("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{ue as default};

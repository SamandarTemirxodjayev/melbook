import{a1 as F,r as m,v as z,a2 as v,c as j,a as r,b as n,w as o,a3 as _,h as d,a4 as I,o as V,d as p,t as b}from"./6MvdGIUj.js";import{q,_ as D,r as M,v as N,x as O}from"./DBpAgGOk.js";import{B as c,C as R,b as G,_ as L,c as Q}from"./CKa3YBXY.js";import{d as x}from"./yughPfh0.js";import"./DXAgjXKp.js";const Y=r("div",{class:"text-2xl font-bold"},"Bannerlar",-1),P={class:"shadow-2xl border border-gray-500 items-center my-4"},J={class:"flex p-4 justify-end"},H=["src"],K={class:"flex flex-col items-center justify-center py-6 gap-3"},W=r("span",{class:"italic text-sm"},"Ma'lumot Mavjud Emas",-1),X={class:"flex items-center justify-between"},Z=r("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Banner Qo'shish ",-1),le={__name:"index",setup(ee){const h=F();let u=m([]),a=m(!1),i=m(!0),f=m(null);z(async()=>{try{const e=await $fetch(c+"/banners",{method:"GET"});u.value=e.data,i.value=!1}catch(e){e.response&&e.response.status===401&&(localStorage.removeItem("token"),v("/exit")),console.log(e)}});const k=[{key:"photo_url",label:"Rasm"},{key:"createdAt",label:"Yaratilgan vaqti"},{key:"updatedAt",label:"Yangilangan vaqti"},{key:"actions",label:"Action"}],w=e=>[[{label:"O'chirish",icon:"i-heroicons-trash-20-solid",click:()=>B(e._id)}]],B=async e=>{i.value=!0;try{const t=await $fetch(c+"/banners/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});if(t.status===200){h.add({title:t.message});const l=await $fetch(c+"/banners",{method:"GET"});u.value=l.data}else h.add({title:t.message})}catch(t){t.response&&t.response.status===401&&(localStorage.removeItem("token"),v("/exit")),console.log(t)}i.value=!1};function T(e){e.target.files.length>0&&(f.value=e.target.files[0])}const U=async()=>{i.value=!0;try{const e=new FormData;e.append("file",f.value);const{data:t}=await $fetch(R+"/upload",{method:"POST",body:e}),l=await $fetch(c+"/banners",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({photo_url:t.fileUrl})});a.value=!1,h.add({title:l.message});const g=await $fetch(c+"/banners",{method:"GET"});f.value=null,u.value=g.data}catch(e){e.response&&e.response.status===401&&(localStorage.removeItem("token"),v("/exit")),console.log(e)}i.value=!1};return q({escape:{usingInput:!0,whenever:[a],handler:()=>{a.value=!1}}}),(e,t)=>{const l=I,g=N,S=D,C=G,y=L,$=Q,A=O,E=M;return V(),j("div",null,[Y,r("div",P,[r("div",J,[n(l,{size:"lg",onClick:t[0]||(t[0]=s=>_(a)?a.value=!0:a=!0)},{default:o(()=>[p("Banner Qo'shish")]),_:1})])]),n(S,{loading:d(i),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Yuklanmoqda..."},progress:{color:"primary",animation:"carousel"},columns:k,rows:d(u),"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Bannerlar Mavjud Emas"}},{"photo_url-data":o(({row:s})=>[r("img",{src:s.photo_url,alt:""},null,8,H)]),"createdAt-data":o(({row:s})=>[p(b(("dateFormat"in e?e.dateFormat:d(x))(s.createdAt)),1)]),"updatedAt-data":o(({row:s})=>[p(b(("dateFormat"in e?e.dateFormat:d(x))(s.updatedAt)),1)]),"actions-data":o(({row:s})=>[n(g,{items:w(s)},{default:o(()=>[n(l,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),"empty-state":o(()=>[r("div",K,[W,n(l,{label:"Banner Qo'shish",onClick:t[1]||(t[1]=s=>_(a)?a.value=!0:a=!0)})])]),_:1},8,["loading","loading-state","rows"]),n(E,{modelValue:d(a),"onUpdate:modelValue":t[3]||(t[3]=s=>_(a)?a.value=s:a=s),"prevent-close":""},{default:o(()=>[n(A,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:o(()=>[r("div",X,[Z,n(l,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:t[2]||(t[2]=s=>_(a)?a.value=!1:a=!1)})])]),default:o(()=>[n($,{onSubmit:U},{default:o(()=>[n(y,{class:"my-[2%]",label:"Banner Uchun Rasm Tanglang",name:"photo",size:"lg"},{default:o(()=>[n(C,{type:"file",size:"lg",onChange:T})]),_:1}),n(y,{class:"my-[2%]",name:"submit",size:"xl"},{default:o(()=>[n(l,{loading:d(i),type:"submit",color:"primary",size:"xl",block:""},{default:o(()=>[p("Tasdiqlash")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{le as default};
